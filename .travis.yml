os: linux
dist: focal
language: shell

addons:
  apt:
    packages:
      - bats

services:
  - docker

install:
  - docker build -t hra1/iipsrv:latest .

before_script:
  - docker run  -dit -p 8000:80 hra1/iipsrv:latest

script:
  - bats test/*.bats

deploy:
  provider: script
  script: bash docker_push
  on:
    branch: master
